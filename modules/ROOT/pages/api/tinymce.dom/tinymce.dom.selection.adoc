= tinymce.dom.Selection

This class handles text and control selection it's an crossbrowser utility class. Consult the TinyMCE Wiki API for more details and examples on how to use this class.

== Examples

[source,prettyprint]
----
// Getting the currently selected node for the active editor
alert(tinymce.activeEditor.selection.getNode().nodeName);
----

[#constructors .anchor]##

== link:#constructors[Constructors]

[cols=",,",options="header",]
|===
|name |summary |defined by
|link:#selection[Selection()] |Constructs a new selection instance. |link:/docs-4x/api/tinymce.dom/tinymce.dom.selection[tinymce.dom.Selection]
|===

[#methods .anchor]##

== link:#methods[Methods]

[cols=",,",options="header",]
|===
|name |summary |defined by
|link:#collapse[collapse()] |Collapse the selection to start or end of range. |link:/docs-4x/api/tinymce.dom/tinymce.dom.selection[tinymce.dom.Selection]
|link:#getbookmark[getBookmark()] |Returns a bookmark location for the current selection. This bookmark object can then be used to restore the selection after some content modification to the document. |link:/docs-4x/api/tinymce.dom/tinymce.dom.selection[tinymce.dom.Selection]
|link:#getcontent[getContent()] |Returns the selected contents using the DOM serializer passed in to this class. |link:/docs-4x/api/tinymce.dom/tinymce.dom.selection[tinymce.dom.Selection]
|link:#getend[getEnd()] |Returns the end element of a selection range. If the end is in a text node the parent element will be returned. |link:/docs-4x/api/tinymce.dom/tinymce.dom.selection[tinymce.dom.Selection]
|link:#getnode[getNode()] |Returns the currently selected element or the common ancestor element for both start and end of the selection. |link:/docs-4x/api/tinymce.dom/tinymce.dom.selection[tinymce.dom.Selection]
|link:#getrng[getRng()] |Returns the browsers internal range object. |link:/docs-4x/api/tinymce.dom/tinymce.dom.selection[tinymce.dom.Selection]
|link:#getsel[getSel()] |Returns the browsers internal selection object. |link:/docs-4x/api/tinymce.dom/tinymce.dom.selection[tinymce.dom.Selection]
|link:#getstart[getStart()] |Returns the start element of a selection range. If the start is in a text node the parent element will be returned. |link:/docs-4x/api/tinymce.dom/tinymce.dom.selection[tinymce.dom.Selection]
|link:#iscollapsed[isCollapsed()] |Returns true/false if the selection range is collapsed or not. Collapsed means if it's a caret or a larger selection. |link:/docs-4x/api/tinymce.dom/tinymce.dom.selection[tinymce.dom.Selection]
|link:#movetobookmark[moveToBookmark()] |Restores the selection to the specified bookmark. |link:/docs-4x/api/tinymce.dom/tinymce.dom.selection[tinymce.dom.Selection]
|link:#select[select()] |Selects the specified element. This will place the start and end of the selection range around the element. |link:/docs-4x/api/tinymce.dom/tinymce.dom.selection[tinymce.dom.Selection]
|link:#selectorchanged[selectorChanged()] |Executes callback when the current selection starts/stops matching the specified selector. The current state will be passed to the callback as it's first argument. |link:/docs-4x/api/tinymce.dom/tinymce.dom.selection[tinymce.dom.Selection]
|link:#setcontent[setContent()] |Sets the current selection to the specified content. If any contents is selected it will be replaced with the contents passed in to this function. If there is no selection the contents will be inserted where the caret is placed in the editor/page. |link:/docs-4x/api/tinymce.dom/tinymce.dom.selection[tinymce.dom.Selection]
|link:#setcursorlocation[setCursorLocation()] |Move the selection cursor range to the specified node and offset. If there is no node specified it will move it to the first suitable location within the body. |link:/docs-4x/api/tinymce.dom/tinymce.dom.selection[tinymce.dom.Selection]
|link:#setnode[setNode()] |Sets the current selection to the specified DOM element. |link:/docs-4x/api/tinymce.dom/tinymce.dom.selection[tinymce.dom.Selection]
|link:#setrng[setRng()] |Changes the selection to the specified DOM range. |link:/docs-4x/api/tinymce.dom/tinymce.dom.selection[tinymce.dom.Selection]
|===

== Constructors

[#selection .anchor]##

=== link:#selection[Selection]

public constructor function Selection(dom:tinymce.dom.DOMUtils, win:Window, serializer:tinymce.dom.Serializer, editor:tinymce.Editor)

Constructs a new selection instance.

==== Parameters

* [.param-name]#dom# link:/docs-4x/api/tinymce.dom/tinymce.dom.domutils[[.param-type]#(tinymce.dom.DOMUtils)#] - DOMUtils object reference.
* [.param-name]#win# [.param-type]#(Window)# - Window to bind the selection object to.
* [.param-name]#serializer# link:/docs-4x/api/tinymce.dom/tinymce.dom.serializer[[.param-type]#(tinymce.dom.Serializer)#] - DOM serialization class to use for getContent.
* [.param-name]#editor# link:/docs-4x/api/tinymce/tinymce.editor[[.param-type]#(tinymce.Editor)#] - Editor instance of the selection.

== Methods

[#collapse .anchor]##

=== link:#collapse[collapse]

collapse(toStart:Boolean)

Collapse the selection to start or end of range.

==== Parameters

* [.param-name]#toStart# [.param-type]#(Boolean)# - Optional boolean state if to collapse to end or not. Defaults to false.

[#getbookmark .anchor]##

=== link:#getbookmark[getBookmark]

getBookmark(type:Number, normalized:Boolean):Object

Returns a bookmark location for the current selection. This bookmark object can then be used to restore the selection after some content modification to the document.

==== Examples

[source,prettyprint]
----
// Stores a bookmark of the current selection
var bm = tinymce.activeEditor.selection.getBookmark();

tinymce.activeEditor.setContent(tinymce.activeEditor.getContent() + 'Some new content');

// Restore the selection bookmark
tinymce.activeEditor.selection.moveToBookmark(bm);
----

==== Parameters

* [.param-name]#type# [.param-type]#(Number)# - Optional state if the bookmark should be simple or not. Default is complex.
* [.param-name]#normalized# [.param-type]#(Boolean)# - Optional state that enables you to get a position that it would be after normalization.

==== Return value

* [.return-type]#Object# - Bookmark object, use moveToBookmark with this object to restore the selection.

[#getcontent .anchor]##

=== link:#getcontent[getContent]

getContent(args:Object):String

Returns the selected contents using the DOM serializer passed in to this class.

==== Examples

[source,prettyprint]
----
// Alerts the currently selected contents
alert(tinymce.activeEditor.selection.getContent());

// Alerts the currently selected contents as plain text
alert(tinymce.activeEditor.selection.getContent({format: 'text'}));
----

==== Parameters

* [.param-name]#args# [.param-type]#(Object)# - Optional settings class with for example output format text or html.

==== Return value

* [.return-type]#String# - Selected contents in for example HTML format.

[#getend .anchor]##

=== link:#getend[getEnd]

getEnd(real:Boolean):Element

Returns the end element of a selection range. If the end is in a text node the parent element will be returned.

==== Parameters

* [.param-name]#real# [.param-type]#(Boolean)# - Optional state to get the real parent when the selection is collapsed not the closest element.

==== Return value

* [.return-type]#Element# - End element of selection range.

[#getnode .anchor]##

=== link:#getnode[getNode]

getNode():Element

Returns the currently selected element or the common ancestor element for both start and end of the selection.

==== Examples

[source,prettyprint]
----
// Alerts the currently selected elements node name
alert(tinymce.activeEditor.selection.getNode().nodeName);
----

==== Return value

* [.return-type]#Element# - Currently selected element or common ancestor element.

[#getrng .anchor]##

=== link:#getrng[getRng]

getRng():Range

Returns the browsers internal range object.

==== Return value

* [.return-type]#Range# - Internal browser range object.

[#getsel .anchor]##

=== link:#getsel[getSel]

getSel():Selection

Returns the browsers internal selection object.

==== Return value

* [.return-type]#Selection# - Internal browser selection object.

[#getstart .anchor]##

=== link:#getstart[getStart]

getStart(real:Boolean):Element

Returns the start element of a selection range. If the start is in a text node the parent element will be returned.

==== Parameters

* [.param-name]#real# [.param-type]#(Boolean)# - Optional state to get the real parent when the selection is collapsed not the closest element.

==== Return value

* [.return-type]#Element# - Start element of selection range.

[#iscollapsed .anchor]##

=== link:#iscollapsed[isCollapsed]

isCollapsed():Boolean

Returns true/false if the selection range is collapsed or not. Collapsed means if it's a caret or a larger selection.

==== Return value

* [.return-type]#Boolean# - true/false state if the selection range is collapsed or not. Collapsed means if it's a caret or a larger selection.

[#movetobookmark .anchor]##

=== link:#movetobookmark[moveToBookmark]

moveToBookmark(bookmark:Object):Boolean

Restores the selection to the specified bookmark.

==== Examples

[source,prettyprint]
----
// Stores a bookmark of the current selection
var bm = tinymce.activeEditor.selection.getBookmark();

tinymce.activeEditor.setContent(tinymce.activeEditor.getContent() + 'Some new content');

// Restore the selection bookmark
tinymce.activeEditor.selection.moveToBookmark(bm);
----

==== Parameters

* [.param-name]#bookmark# [.param-type]#(Object)# - Bookmark to restore selection from.

==== Return value

* [.return-type]#Boolean# - true/false if it was successful or not.

[#select .anchor]##

=== link:#select[select]

select(node:Element, content:Boolean):Element

Selects the specified element. This will place the start and end of the selection range around the element.

==== Examples

[source,prettyprint]
----
// Select the first paragraph in the active editor
tinymce.activeEditor.selection.select(tinymce.activeEditor.dom.select('p')[0]);
----

==== Parameters

* [.param-name]#node# [.param-type]#(Element)# - HTML DOM element to select.
* [.param-name]#content# [.param-type]#(Boolean)# - Optional bool state if the contents should be selected or not on non IE browser.

==== Return value

* [.return-type]#Element# - Selected element the same element as the one that got passed in.

[#selectorchanged .anchor]##

=== link:#selectorchanged[selectorChanged]

selectorChanged(selector:String, callback:function)

Executes callback when the current selection starts/stops matching the specified selector. The current state will be passed to the callback as it's first argument.

==== Parameters

* [.param-name]#selector# [.param-type]#(String)# - CSS selector to check for.
* [.param-name]#callback# [.param-type]#(function)# - Callback with state and args when the selector is matches or not.

[#setcontent .anchor]##

=== link:#setcontent[setContent]

setContent(content:String, args:Object)

Sets the current selection to the specified content. If any contents is selected it will be replaced with the contents passed in to this function. If there is no selection the contents will be inserted where the caret is placed in the editor/page.

==== Examples

[source,prettyprint]
----
// Inserts some HTML contents at the current selection
tinymce.activeEditor.selection.setContent('<strong>Some contents</strong>');
----

==== Parameters

* [.param-name]#content# [.param-type]#(String)# - HTML contents to set could also be other formats depending on settings.
* [.param-name]#args# [.param-type]#(Object)# - Optional settings object with for example data format.

[#setcursorlocation .anchor]##

=== link:#setcursorlocation[setCursorLocation]

setCursorLocation(node:Node, offset:Number)

Move the selection cursor range to the specified node and offset. If there is no node specified it will move it to the first suitable location within the body.

==== Parameters

* [.param-name]#node# [.param-type]#(Node)# - Optional node to put the cursor in.
* [.param-name]#offset# [.param-type]#(Number)# - Optional offset from the start of the node to put the cursor at.

[#setnode .anchor]##

=== link:#setnode[setNode]

setNode(elm:Element):Element

Sets the current selection to the specified DOM element.

==== Examples

[source,prettyprint]
----
// Inserts a DOM node at current selection/caret location
tinymce.activeEditor.selection.setNode(tinymce.activeEditor.dom.create('img', {src: 'some.gif', title: 'some title'}));
----

==== Parameters

* [.param-name]#elm# [.param-type]#(Element)# - Element to set as the contents of the selection.

==== Return value

* [.return-type]#Element# - Returns the element that got passed in.

[#setrng .anchor]##

=== link:#setrng[setRng]

setRng(rng:Range, forward:Boolean)

Changes the selection to the specified DOM range.

==== Parameters

* [.param-name]#rng# [.param-type]#(Range)# - Range to select.
* [.param-name]#forward# [.param-type]#(Boolean)# - Optional boolean if the selection is forwards or backwards.
